rule Detect_Bat_Cmd_File
{
    meta:
	description = "Rule to detect .bat or .cmd"
	author = "unknown"
	date = "2023-09-10"
	rule_version = "v1"
	type = "warning"
	warning = "file used to execute commands from the Windows command line" 
	thread = 3
    strings:
        $cmd_magic = {EB 01 31 C0 99 AC 74 0A C1 CA 0D 01 C2 EB F1 5A} // Đây là chữ ký (magic bytes) của tệp .cmd
		$bat_cmd_signature = /(\x40echo off|\x40echo on)/
    condition:
        any of them
}