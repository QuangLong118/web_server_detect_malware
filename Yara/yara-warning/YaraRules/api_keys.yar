rule generic_api
{
    meta:
	description = "This rule will look for standard API Keys."
        author = "@KevTheHermit"
        info = "Part of PasteHunter"
        reference = "https://github.com/kevthehermit/PasteHunter"
	warning = "generic_API can be used "
	thread = 5
    strings:
        $a1 = "apikey" nocase
        $a2 = "api_key" nocase
        $hash32 = /\b[a-fA-F\d]{32}\b/
        $hash64 = /\b[a-fA-F\d]{64}\b/
        $n1 = "#EXTINF"
        $n2 = "m3u8"
        $n3 = "Chocolatey is running"

    condition:
        (any of ($a*)) and (any of ($hash*)) and (not any of ($n*))

}

rule twitter_api
{
    meta:
        description = "This rule will look for standard API Keys."
        author = "@KevTheHermit"
        info = "Part of PasteHunter"
        reference = "https://github.com/kevthehermit/PasteHunter"
	warning = "twister_API can be used "
	thread = 5
    strings:
        $a = "consumer_key" nocase
        $b = "consumer_secret" nocase
        $c = "access_token" nocase
    condition:
        all of them

}

rule google_api
{
    meta:
        description = "This rule will look for standard API Keys."
        author = "@KevTheHermit"
        info = "Part of PasteHunter"
        reference = "https://github.com/kevthehermit/PasteHunter"
	warning = "google_API can be used "
	thread = 5
    strings:
        $a = /\bAIza.{35}\b/
    condition:
        any of them
}

rule slack_api
{
    meta:
        description = "This rule will look for standard API Keys."
        author = "@KevTheHermit"
        info = "Part of PasteHunter"
        reference = "https://github.com/kevthehermit/PasteHunter"
	warning = "slack_API can be used "
	thread = 5
    strings:
        $a = /(xox(p|b|o|a)-[0-9]{9,12}-[0-9]{9,12}-[0-9]{9,12}-[a-z0-9]{32})/
        $b = "hooks.slack.com" nocase
    condition:
        any of them
}

rule github_api
{
    meta:
        description = "This rule will look for standard API Keys."
        author = "@KevTheHermit"
        info = "Part of PasteHunter"
        reference = "https://github.com/kevthehermit/PasteHunter"
	warning = "github_API can be used "
	thread = 5
    strings:
        $a = /[g|G][i|I][t|T][h|H][u|U][b|B].*[[\'|"]0-9a-zA-Z]{35,40}[\'|"]/
    condition:
        any of them
}

rule aws_api
{
    meta:
        description = "This rule will look for standard API Keys."
        author = "@KevTheHermit"
        info = "Part of PasteHunter"
        reference = "https://github.com/kevthehermit/PasteHunter"
	warning = "aws_API can be used "
	thread = 5
    strings:
        $a = /AKIA[0-9A-Z]{16}/
    condition:
        any of them
}

rule heroku_api
{
    meta:
        description = "This rule will look for standard API Keys."
        author = "@KevTheHermit"
        info = "Part of PasteHunter"
        reference = "https://github.com/kevthehermit/PasteHunter"
	warning = "heroku_API can be used "
	thread = 5
    strings:
        $a = /[h|H][e|E][r|R][o|O][k|K][u|U].*[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}/
    condition:
        any of them
}

rule discord_api
{
    meta:
       description = "This rule will look for standard API Keys."
        author = "@KevTheHermit"
        info = "Part of PasteHunter"
        reference = "https://github.com/kevthehermit/PasteHunter"
	warning = "discord_API can be used "
	thread = 5
    strings:
        $a = "DiscordRelay.BotToken" nocase
        $b = "discordapp.com/api/webhooks" nocase
    condition:
        any of them
}
