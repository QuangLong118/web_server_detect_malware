rule warning_registry_1
{
	meta:
	
		description = "Rule to detect accessing registry"
		author = "unknown"
		date = "2023-09-10"
		rule_version = "v1"
		type = "warning"
		warning = "file can change registry - level 4" 
		thread = 5
	strings:

		$str1 = "Registry" nocase ascii
		$str2 = "RegOpenKeyEX" nocase ascii
		$str3 = "RegCreateKeyEx" nocase ascii
		$str4 = "RegSetValueEx" nocase ascii
		$str5 = "RegCloseKey" nocase ascii
		$str6 = "Window.Win32" nocase ascii
		$str7 = "HKEY_CLASSES_ROOT" nocase ascii
		$str8 = "HKEY_LOCAL_MACHINE" nocase ascii
		$str9 =	"HKEY_USERS" nocase ascii
		$str10 = "HKEY_CURRENT_CONFIG" nocase ascii
		$str11 ="HKEY_DYNAMIC_DATA" nocase ascii

	condition :
		any of them
}

rule warning_registry_2
{
	meta:
		description = "Rule to detect accessing registry"
		author = "unknown"
		date = "2023-09-10"
		rule_version = "v1"
		type = "warning"
		warning = "file can change registry - level 7" 
		thread = 8
	strings:
		$str1 = "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run" nocase ascii
		$str2 = "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run" nocase ascii
	condition :
		any of them
}

