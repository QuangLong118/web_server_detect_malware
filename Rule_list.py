import os

def get_files_in_folder(folder_name):
    rule_paths = []
    # Lấy đường dẫn của thư mục làm việc hiện tại
    current_directory = os.getcwd()
    parent_directory = os.path.dirname(current_directory)
    # Lặp qua tất cả các thư mục và tập tin trong thư mục làm việc hiện tại
    for root, dirs, files in os.walk(parent_directory):
        # Kiểm tra xem có thư mục có tên cần tìm không
        if folder_name in dirs:
            # Nếu có, Lấy đường dẫn đến thư mục
            folder_rule_path = os.path.join(root, folder_name)
            # Sử dụng vòng lặp để duyệt qua tất cả các tệp trong thư mục
            for root, dirs, files in os.walk(folder_rule_path):
                for file in files:
                    # Tạo đường dẫn tới tệp và thêm nó vào danh sách      
                    if file.endswith('.yar') or file.endswith('.yara'):
                        rule_path = os.path.join(root, file)
                        rule_paths.append(rule_path)
    # Nếu không tìm thấy, trả về None
    if len(rule_paths)==0:
        return None
    # Trả về danh sách đường dẫn đến các luật
    return rule_paths

# rule_paths = get_files_in_folder('yara-warning')
# print(rule_paths)